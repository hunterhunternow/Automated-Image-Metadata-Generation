# Automated Image Metadata Generator

This Python script automates the generation of descriptive metadata (tags and captions) for images. It leverages Google Cloud Vision API for tag generation and Astica API for creating descriptive captions. The script can process local images or images uploaded via Google Colab, and exports the metadata to a CSV file.

## Features

-   In-place image compression and resizing (configurable).
-   Tag generation using Google Cloud Vision API.
-   Description generation using Astica API.
-   Supports processing a single image file or all compatible images in a directory (local execution).
-   Interactive image and credential uploading when run in Google Colab.
-   Exports metadata (filename, description, tags) to a CSV file (`image_metadata.csv`).
-   Securely manages API keys and credentials using environment variables and `.env` files.

## Prerequisites

-   Python 3.7+
-   Access to Google Cloud Platform:
    -   A project with the Vision API enabled.
    -   A service account key JSON file for authentication.
-   An API key from Astica ([https://astica.ai](https://astica.ai)).

## Setup

1.  **Clone the repository (or download the files):**
    ```bash
    # Example: git clone [https://github.com/yourusername/your-repo-name.git](https://github.com/yourusername/your-repo-name.git)
    # cd your-repo-name
    ```

2.  **Create and activate a virtual environment (recommended):**
    ```bash
    python -m venv venv
    # On macOS/Linux:
    source venv/bin/activate
    # On Windows:
    # venv\Scripts\activate
    ```

3.  **Install dependencies:**
    ```bash
    pip install -r requirements.txt
    ```

4.  **Configure Environment Variables:**
    Create a file named `.env` in the root of the project directory. Copy the contents of `.env_example` into it and fill in your actual credentials:

    ```env
    # .env file content
    GOOGLE_APPLICATION_CREDENTIALS="/path/to/your/gcp-service-account-key.json"
    ASTICA_API_KEY="YOUR_ASTICA_API_KEY_HERE"
    ```
    **Important:**
    -   Replace `/path/to/your/gcp-service-account-key.json` with the absolute path to your Google Cloud service account key file.
    -   Replace `YOUR_ASTICA_API_KEY_HERE` with your actual Astica API key.
    -   Ensure the `.env` file is listed in your `.gitignore` file to prevent committing secrets.

    Alternatively, you can set these as system-wide environment variables.

## Usage

### Running Locally

1.  Ensure your virtual environment is activated and your `.env` file is configured.
2.  Run the script from your terminal:
    ```bash
    python your_script_name.py # Replace your_script_name.py with the actual script filename
    ```
3.  The script will prompt you to enter the path to either a directory containing images or a single image file.

### Running in Google Colab

1.  Upload the Python script (`your_script_name.py`) and your `.env` file (or set environment variables manually in Colab cells) to your Google Colab environment.
    *To set environment variables in Colab cells (if not using `.env`):*
    ```python
    import os
    os.environ['ASTICA_API_KEY'] = 'YOUR_ASTICA_KEY_HERE'
    # For Google Credentials, if not using .env, the script will prompt for upload if GOOGLE_APPLICATION_CREDENTIALS is not found.
    ```
2.  Run the script.
3.  If `GOOGLE_APPLICATION_CREDENTIALS` is not detected from the environment, Colab will prompt you to upload your Google Cloud service account key JSON file.
4.  Next, Colab will prompt you to upload the image(s) you want to process.
5.  The generated `image_metadata.csv` file will be automatically offered for download at the end of the script.

## Output

The script generates a CSV file named `image_metadata.csv` in the same directory where the script is run (or offers it for download in Colab). The CSV file contains the following columns:
* `Filename`: The name of the image file.
* `Description`: The description generated by Astica API (or an error/status message).
* `Tags`: Comma-separated tags generated by Google Cloud Vision API (or an error/status message).
